name: Deployment

concurrency: production

on:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: home-vm-01 # I have a second runner configured
    steps:
      - name: git pull on remote server # name of your workflow
        uses: actions/checkout@v3
    # - name: automated back up of local docker volumes (step to be added later)
      - name: restart remote containers
        run: | 
          cd ~/media-server_v2.0
          git pull
          for container in traefik portainer jellyfin cadvisor
          do
           cd ~/media-server_v2.0/containers/$container
           docker compose up -d --force-recreate
          done